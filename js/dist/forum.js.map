{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@huseyinfiliz/sort-changer/webpack/bootstrap","webpack://@huseyinfiliz/sort-changer/webpack/runtime/compat get default export","webpack://@huseyinfiliz/sort-changer/webpack/runtime/define property getters","webpack://@huseyinfiliz/sort-changer/webpack/runtime/hasOwnProperty shorthand","webpack://@huseyinfiliz/sort-changer/external root \"flarum.core.compat['common/app']\"","webpack://@huseyinfiliz/sort-changer/./src/common/index.ts","webpack://@huseyinfiliz/sort-changer/external root \"flarum.core.compat['common/extend']\"","webpack://@huseyinfiliz/sort-changer/external root \"flarum.core.compat['forum/app']\"","webpack://@huseyinfiliz/sort-changer/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@huseyinfiliz/sort-changer/./src/forum/index.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/app'];","import app from 'flarum/common/app';\n\napp.initializers.add('huseyinfiliz-sort-changer-common', () => {\n  console.log('[huseyinfiliz/sort-changer] Hello, forum and admin!');\n});\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","import { extend } from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport IndexPage from 'flarum/forum/components/IndexPage';\n\napp.initializers.add('huseyinfiliz-sort-changer', () => {\n  console.log('[SortChanger] Uzantı başlatıldı');\n  let wasOnIndex = false;\n  \n  extend(IndexPage.prototype, 'oninit', function(vnode) {\n    // Tag veya arama parametresi varsa çık\n    if (m.route.param('tags') || m.route.param('q')) {\n      return;\n    }\n    \n    const defaultSort = app.forum.attribute('sortChangerDefaultSort');\n    const currentSort = m.route.param('sort');\n    \n    // İlk yüklemede varsayılan sıralama parametresi varsa temizle\n    if (currentSort === defaultSort && !wasOnIndex) {\n      // URL'den sort parametresini temizle\n      const params = Object.assign({}, m.route.param() || {});\n      delete params.sort;\n      delete params.key;\n      \n      // URL'i temizle (sıralama zaten uygulanmış durumda)\n      window.history.replaceState(null, '', app.route('index', params));\n    }\n    // Sort parametresi yoksa ve varsayılan ayar varsa\n    else if (!wasOnIndex && !currentSort && defaultSort && defaultSort !== 'latest') {\n      const params = Object.assign({}, m.route.param() || {});\n      delete params.key;\n      params.sort = defaultSort;\n      \n      setTimeout(() => {\n        m.route.set(app.route('index', params), true, { replace: true });\n        \n        // Hemen URL'i temizle (varsayılan olduğu için)\n        setTimeout(() => {\n          window.history.replaceState(null, '', app.route('index', {}));\n        }, 50);\n      }, 0);\n    }\n    \n    wasOnIndex = true;\n  });\n  \n  extend(IndexPage.prototype, 'onremove', function() {\n    wasOnIndex = false;\n  });\n  \n  // Dropdown'daki Latest butonunu değiştir\n  extend(IndexPage.prototype, 'oncreate', function(vnode) {\n    // Tag veya arama parametresi varsa çık\n    if (m.route.param('tags') || m.route.param('q')) {\n      return;\n    }\n    \n    const defaultSort = app.forum.attribute('sortChangerDefaultSort');\n    \n    console.log('[SortChanger] oncreate - Dropdown aranıyor...');\n    \n    let attempts = 0;\n    const maxAttempts = 10;\n    \n    const checkAndModify = () => {\n      attempts++;\n      \n      let dropdownMenu = document.querySelector('.item-sort .Dropdown-menu');\n      if (!dropdownMenu) {\n        dropdownMenu = document.querySelector('.Dropdown-menu');\n      }\n      \n      if (dropdownMenu) {\n        const buttons = dropdownMenu.querySelectorAll('li button');\n        \n        buttons.forEach((button) => {\n          const label = button.querySelector('.Button-label');\n          const labelText = label ? label.textContent.trim() : '';\n          \n          if (labelText === 'Latest') {\n            button.onclick = (e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              \n              console.log('[SortChanger] Latest tıklandı!');\n              \n              // Eğer latest varsayılan ise URL'e ekleme\n              if (defaultSort === 'latest') {\n                // Sadece sıralamayı değiştir, URL'e ekleme\n                if (app.discussions) {\n                  app.discussions.refreshParams({sort: ''});\n                  app.discussions.refresh();\n                }\n              } else {\n                // Latest varsayılan değilse URL'e ekle\n                const params = Object.assign({}, m.route.param() || {});\n                delete params.key;\n                params.sort = 'latest';\n                \n                m.route.set(app.route('index', params));\n                \n                if (app.discussions) {\n                  app.discussions.refreshParams({sort: ''});\n                  app.discussions.refresh();\n                }\n              }\n              \n              // Dropdown'u kapat\n              const dropdown = button.closest('.Dropdown');\n              if (dropdown) {\n                dropdown.classList.remove('open');\n              }\n            };\n            \n            console.log('[SortChanger] Latest butonu güncellendi!');\n          }\n        });\n      } else if (attempts < maxAttempts) {\n        setTimeout(checkAndModify, 500);\n      }\n    };\n    \n    setTimeout(checkAndModify, 500);\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","app","add","console","log","wasOnIndex","extend","IndexPage","vnode","m","route","param","defaultSort","attribute","currentSort","params","assign","sort","setTimeout","set","replace","window","history","replaceState","attempts","checkAndModify","dropdownMenu","document","querySelector","querySelectorAll","forEach","button","label","textContent","trim","onclick","e","preventDefault","stopPropagation","refreshParams","refresh","dropdown","closest","classList","remove"],"sourceRoot":""}